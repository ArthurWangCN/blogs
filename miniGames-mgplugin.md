---
title: 小游戏交叉营销方案
date: 2018-06-01 10:33:55
tags: [游戏开发, 小游戏]
categories: 游戏开发
---

## 目的
为发行小游戏提供更多流量资源，实现流量合理再分配，提升小游戏用户整体长线留存，推出了小游戏交叉营销方案。

![场景](http://blogpic.at15cm.com/mg-scene.jpg)



## 游戏推荐策略
+ 所有游戏，优先第一个资源位由**研发方**决定（没有可推荐游戏则无；关注推荐效率）
宗旨：基于发行业务整体层面考虑，尽可能实现公平公正透明化，同时适当兼顾开 发商意愿，给头部大DAU游戏适当倾斜

+ 剩余资源位基于游戏多维度数据表现，由IEG发行团队共同确定

### 优先第一个资源位由开发商控制
所有游戏，优先第一个资源位由研发方决定

+ 优先第一个资源位游戏由研发方控制指定，没有可推荐游戏则无
+ 关注推荐效率，对于高贡献的自研游戏可以微信中心化资源做反哺 
+ 以月为周期，每月可重置推荐游戏
+ 游戏与推荐游戏需关联共同公众号


### 剩余资源基于游戏表现决定
剩余资源位基于游戏多维度数据表现进行选择 

+ 根据小游戏在微信小游戏模块的整体数据表现筛选推荐游戏池
+ 指标维度：高吸量、高质量、高付费
  1. 吸量能力：新进
  2. 用户质量：留存（次留、3留、7留）、活跃度、在线时长、登录次数 
  3. 付费能力：付费渗透率、活跃arpu值  
+ 推荐游戏池若超过7个，可根据游戏类型等进行分组（一组7个），不同游戏 可以进行不同组合推荐
+ 以月为周期，每月可重置推荐游戏池
+ 游戏与推荐游戏组合需关联共同公众号


### 公众号关联限制解决方案
**限制条件：**小程序跳转必须基于关联同一公众帐号下，且**一个公众号最多可关联10个**同公司主体小程序

**解决方案：**

+ 每个游戏申请各自单游戏公众号
+ 每个游戏公众号关联推荐的8款游戏（1个厂商指定小游戏+7个筛选小游戏游戏）和合集小程序
+ 以月为周期，每月根据重置推荐游戏池对每个游戏公众号进行解绑和推荐游戏重新关联


![关联小游戏](http://blogpic.at15cm.com/mg-bind10.jpg)
     

## 接入说明&准备事项
### 支持引擎
当前支持游戏引擎为：cocos creator、laya和egret。cocos 2dx引擎正在开发中，预计5.25能启动接入。后续会陆续补充覆盖更多引擎版本。 

### 当前方案
由于微信小游戏跳转接口还未开放，当前需要通过小程序码实现跳转。如下：

![当前方案](http://blogpic.at15cm.com/mg-solution.jpg)

说明：游戏内首页一级入口提供 `更多游戏` 按钮，点击展示推荐游戏list。在微信开放能力之前，点击单游戏，展示单游戏推荐图片，长按识别小程序码跳转。待微信小游戏跳转接 口开放后，点击直接打开游戏。

### 后续直接跳转方案
受限于微信小游戏之间跳转限制（详见附录），为实现交叉营销游戏之间的跳转，需要进行以下操作：
#### 接入前准备
1. 每个游戏需申请建立公众账号，且公众号主体必须挂在腾讯下（**深圳市腾讯计算机系统有限公司**）
![腾讯](http://blogpic.at15cm.com/mg-tencent.jpg)
2. 游戏公众号需关联该对应小游戏，关联流程：登录公众号后台-小程序-小程序管理-添加-关联小程序  
 

#### 接入完成运营事项 
1. 插件接入完成后，上线前需提前将推荐游戏关联至对应游戏公众号下（关联流程同上）
2. 后续需要以月为周期更新游戏公众号关联游戏名单 


## 接入文档
### laya接入文档
#### TypeScript版
##### 使用前配置
由于插件需要访问自身后台和cdn，因此需要接入的小游戏添加安全域名，其中request合法域名需添加<https://goplatform.minigame.qq.com> ，由于插件会下载图片，而laya的图片小游戏适配层的缓存机制，会调用wx.downloadFile接口下载图片，所以也需要添加<https://platform.minigame.qq.com>为 **downloadFile** 的合法域名。

##### 模块引入
把 `RecommendUI.ts` 放到游戏工程的src下，如下图所示：

![模块引入](http://blogpic.at15cm.com/mg-filetree.png)

##### UI初始化
游戏可先实例化UI节点，添加到游戏的舞台或者某个节点下（此时不会立刻展示出推荐游戏的UI）

```
let t = new mgplugin.RecommendUI({appid: xxx});
Laya.stage.addChild(t);
```

实例化RecommendUI的时候，需要传入微信小游戏的appid。接着，游戏可按需（例如点击游戏中的“更多游戏”按钮）调用实例的show来展示出推荐游戏。

`t.show();`

#### ActionScript版
同理，代码如下：

在游戏逻辑中引入插件的UI模块

`import mgplugin.RecommendUI;`

然后游戏可先实例化RecommendUI，添加到游戏的舞台或者某个节点下（此时不会立刻展示出推荐游戏的UI）

```
var t:RecommendUI = new RecommendUI({appId: xxx});
Laya.stage.addChild(t);
```

实例化的时候需要传入微信小游戏的appid。接着，游戏可按需（例如点击游戏中的“更多游戏”按钮）调用实例的show来展示出推荐游戏。

`t.show();`


#### 关于上层节点的形变问题
插入插件的节点时，请尽量避免上层节点的缩放等形变操作（会影响到下层节点），若实在无法避免，可对插件节点进行形变调整以保证显示正常。


#### 插件节点的销毁
由于插件节点寄宿在游戏的场景中，当场景销毁时，请确保插件节点完全销毁，重新进入含插件场景时再进行构造创建。


#### 渠道上报
目前营销插件对于显示的游戏跳转，添加了渠道上报，通过交叉营销插件跳转进入的小游戏，若也引入了营销插件，则可直接调用插件中的接口进行渠道上报：

举例场景：玩家在游戏A中点击插件的游戏，通过扫二维码进入了游戏B，若游戏B接入了插件，则游戏B可以在游戏初始化的时候调用渠道上报的接口进行渠道上报。

Actionscript需要先引入 `enterReport.as` 文件，并且将函数import导入:

`import mgplugin.enterReport;`

调用：

`enterReport('wxxxxxxxxxx', 'test');`

typescript直接调用即可：

`mgplugin.enterReport('wxxxxxxxxxx', 'test');`

接口的参数分别是：游戏的appid，用户的id（尽量使用openid，若无则使用游戏后台定义的用户id，主要用于保证上报用户的唯一性）。


#### 插件开关
建议游戏方对插件的显示通过运营管理端进行配置，这样如果插件部分出问题，可以通过管理端配置立即关闭游戏插件的显示，避免影响用户体验。


## 附录
### 插件游戏跳转限制条件 
小程序跳转必须基于关联同一公众帐号下，且一个公众号最多可关联10个同公司主体小程序，3个不同主体的小程序 
![api](http://blogpic.at15cm.com/mg-api.jpg)

### 三种引擎文档及源码

+ [laya引擎文档及源码](http://awstudio.cn/www/blogFiles/laya.rar)
+ [egret引擎文档及源码](http://awstudio.cn/www/blogFiles/egret.rar)
+ [cocos-creator引擎文档及源码](http://awstudio.cn/www/blogFiles/cocos-creator.rar)


